/*! feature-viewer 2016-03-28 */
var FeatureViewer=function(){function a(a,b,c){function d(a,b){M!=={}&&d3.select(M.id).style("fill",M.originalColor),"path"!==b.type&&"line"!==b.type&&(M={id:a,originalColor:d3.select(a).style("fill")||b.color},d3.select(a).style("fill","orangered"))}function e(a,b){for(var c=a-110,d="",e=0;e<b.length;e++)if(Q(b[e].x)<c&&Q(b[e+1].x)>c){d=c-Q(b[e].x)<Q(b[e+1].x)-c?b[e]:b[e+1];break}return d}function f(a){return Q(a.x===a.y?a.x-.4:a.x)}function g(a){return a.x===a.y?Q(a.x+.4)-Q(a.x-.4)<2?2:Q(a.x+.4)-Q(a.x-.4):Q(a.y)-Q(a.x)}function h(a){var b=[];return a.forEach(function(a){if(b===[])b.push(a.y),a.level=0;else{for(var c=!1,d=0;d<b.length;d++)if(a.x>b[d]){c=!0,a.level=d,b[d]=a.y;break}c===!1&&(b.push(a.y),a.level=b.length-1)}}),b.length}function i(a,b,c){if("number"!=typeof a||-1>a||a>1||"string"!=typeof b||"r"!=b[0]&&"#"!=b[0]||"string"!=typeof c&&"undefined"!=typeof c)return null;this.sbcRip||(this.sbcRip=function(a){var b=a.length,c=new Object;if(b>9){if(a=a.split(","),a.length<3||a.length>4)return null;c[0]=d(a[0].slice(4)),c[1]=d(a[1]),c[2]=d(a[2]),c[3]=a[3]?parseFloat(a[3]):-1}else{if(8==b||6==b||4>b)return null;6>b&&(a="#"+a[1]+a[1]+a[2]+a[2]+a[3]+a[3]+(b>4?a[4]+""+a[4]:"")),a=d(a.slice(1),16),c[0]=a>>16&255,c[1]=a>>8&255,c[2]=255&a,c[3]=9==b||5==b?e((a>>24&255)/255*1e4)/1e4:-1}return c});var d=parseInt,e=Math.round,f=b.length>9,f="string"==typeof c?c.length>9?!0:"c"==c?!f:!1:f,g=0>a,a=g?-1*a:a,c=c&&"c"!=c?c:g?"#000000":"#FFFFFF",h=sbcRip(b),i=sbcRip(c);return h&&i?f?"rgb("+e((i[0]-h[0])*a+h[0])+","+e((i[1]-h[1])*a+h[1])+","+e((i[2]-h[2])*a+h[2])+(h[3]<0&&i[3]<0?")":","+(h[3]>-1&&i[3]>-1?e(1e4*((i[3]-h[3])*a+h[3]))/1e4:i[3]<0?h[3]:i[3])+")"):"#"+(4294967296+16777216*(h[3]>-1&&i[3]>-1?e(255*((i[3]-h[3])*a+h[3])):i[3]>-1?e(255*i[3]):h[3]>-1?e(255*h[3]):255)+65536*e((i[0]-h[0])*a+h[0])+256*e((i[1]-h[1])*a+h[1])+e((i[2]-h[2])*a+h[2])).toString(16).slice(h[3]>-1||i[3]>-1?1:3):null}function j(a){z.append("g").attr("class","x axis Xaxis").attr("transform","translate(0,"+(a+20)+")").call(Z)}function k(a){z.selectAll(".Xaxis").attr("transform","translate(0,"+(a+20)+")")}function l(a){y.attr("height",a+60+"px")}function m(){A=y.append("g").attr("class","pro axis").attr("transform","translate(0,"+N.top+")"),n()}function n(){B=A.selectAll(".yaxis").data(G).enter().append("g"),B.append("polygon").attr("class",function(a){return a.filter?a.filter.split(" ").join("_")+"Arrow":"Arrow"}).style("stroke","").style("fill","#DFD5D3").attr("points",function(a){return N.left-105+","+(a.y-3)+", "+(N.left-105)+","+(a.y+12)+", "+(N.left-15)+","+(a.y+12)+", "+(N.left-7)+","+(a.y+4.5)+", "+(N.left-15)+","+(a.y-3)}),B.append("text").attr("class","yaxis").attr("text-anchor","start").attr("x",function(){return N.left-102}).attr("y",function(a){return a.y+8}).text(function(a){return a.title})}function o(a){a.on("mousedown",function(){brush_elm=y.select(".brush").node(),new_click_event=new Event("mousedown"),new_click_event.pageX=d3.event.pageX,new_click_event.clientX=d3.event.clientX,new_click_event.pageY=d3.event.pageY,new_click_event.clientY=d3.event.clientY,brush_elm.dispatchEvent(new_click_event)})}function p(){z.append("g").attr("class","brush").call(da).selectAll("rect").attr("height",H+50)}function q(){d3.select(b).selectAll("div.selectedRect").remove(),M!=={}&&(d3.select(M.id).style("fill",M.originalColor),M={});var c=da.extent(),d=Math.abs(c[0]-c[1]);if(c[0]<c[1])var e=parseInt(c[0]-1),f=parseInt(c[1]+1);else var e=parseInt(c[1]+1),f=parseInt(c[0]-1);var g=T(d);if(!da.empty()&&d>L){var h=(a.length/d).toFixed(1);$(b+" .zoomUnit").text(h.toString()),E.showSequence&&g&&z.selectAll(".AA").empty()&&(J=e,ba.sequence(a.substring(e,f),20,J)),Q.domain(c),R.range(c),s(D,J),t(),d3.select(b).selectAll(".brush").call(da.clear())}else d3.select(b).selectAll(".brush").call(da.clear())}function r(){$(".zoomUnit").text("1"),Q.domain([1,a.length]),R.range([1,a.length]);var b=T(a.length);b!==!1||z.selectAll(".AA").empty()||z.selectAll(".seqGroup").remove(),s(D,0),t()}function s(a,b){a.forEach(function(a){"rect"===a.type?ca.rectangle(a):"multipleRect"===a.type?ca.multiRec(a):"unique"===a.type?ca.unique(a):"path"===a.type?ca.path(a):"line"===a.type?ca.line(a):"text"===a.type&&ca.text(a,b)})}function t(){z.transition().duration(500).select(".x.axis").call(Z)}function u(){var a=d3.select(".chart").append("div").attr("class","Vline").style("position","absolute").style("z-index","19").style("width","1px").style("height",H+50+"px").style("top","30px").style("background","#000");d3.select(".chart").on("mousemove.Vline",function(){mousex=d3.mouse(this)[0]-2,a.style("left",mousex+"px")})}function v(b,c){if("undefined"==typeof c)var c={showAxis:!1,showSequence:!1,brushActive:!1,verticalLine:!1,toolbar:!1,bubbleHelp:!1,zoomMax:50};if($.fn.popover||(c.bubbleHelp=!1,console.warn("The bubble help requires tooltip and popover bootrstrap js libraries. The feature viewer will continue to work, but without the info bubble")),c.zoomMax&&(L=c.zoomMax),c.toolbar===!0){var d=$(b+" .svgHeader").length?d3.select(b+" .svgHeader"):d3.select(b).append("div").attr("class","svgHeader");if(!$(b+" .header-zoom").length){var e=d.append("div").attr("class","panel panel-default header-zoom").style("display","inline-block").style("width","150px").style("margin","20px 0px 0px").style("padding","0px");e.append("div").attr("class","panel-heading").style("padding","0px 15px").style("border-right","1px solid #DDD").style("display","inline-block").style("width","80px").append("h5").style("padding","0px").style("height","10px").style("color","#777").text("ZOOM"),e.append("div").attr("class","panel-body").style("display","inline-block").style("padding","0px").append("h5").style("padding-left","15px").style("height","10px").text("x ").append("span").attr("class","zoomUnit").text("1")}if(!$(b+" .header-position").length){var f=d.append("div").attr("class","panel panel-default header-position").style("display","inline-block").style("width","175px").style("margin","20px 20px 0px").style("padding","0px");f.append("div").attr("class","panel-heading").style("padding","0px 15px").style("border-right","1px solid #DDD").style("display","inline-block").append("h5").style("padding","0px").style("height","10px").style("color","#777").text("POSITION"),f.append("div").attr("class","panel-body").style("display","inline-block").style("padding","0px").append("h5").style("padding-left","15px").style("height","10px").append("span").attr("id","zoomPosition").text("0")}if(c.bubbleHelp===!0&&!$(b+" .header-help").length){var g="<div><strong>To zoom in :</strong> Left click to select area of interest</div><div><strong>To zoom out :</strong> Right click to reset the scale</div><div><strong>Zoom max  :</strong> Limited to <strong>"+L.toString()+" units</strong></div>",h=d.append("div").attr("class","pull-right").style("display","inline-block").style("margin","25px 35px 0px 0px").style("padding","0px"),i=h.append("a").attr("type","button").attr("class","header-help").attr("data-toggle","popover").attr("data-placement","left").attr("title","Help").attr("data-content",g).style("font-size","1.5em");i.append("span").attr("class","label label-as-badge").text("?"),$(function(){$('[data-toggle="popover"]').popover({html:!0})})}}y=d3.select(b).append("svg").attr("width",O+N.left+N.right).attr("height",P+N.top+N.bottom).style("z-index","2").on("contextmenu",function(a,b){d3.event.preventDefault(),r()}),x=C.getElementsByTagName("svg")[0],z=y.append("g").attr("transform","translate("+N.left+","+N.top+")");var k=z.append("defs");k.append("clipPath").attr("id","clip").append("rect").attr("width",O).attr("height",P);var n=k.append("filter").attr("id","dropshadow").attr("height","200%");n.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",3).attr("result","blur"),n.append("feOffset").attr("in","blur").attr("dx",-2).attr("dy",2).attr("result","offsetBlur");var o=n.append("feMerge");o.append("feMergeNode").attr("in","offsetBlur"),o.append("feMergeNode").attr("in","SourceGraphic"),z.on("mousemove",function(){var a=d3.mouse(d3.select(".background").node());$(b+" #zoomPosition").text(Math.round(R(a[0])))}),c.showSequence&&(E.showSequence=!0,T(a.length)&&ba.sequence(a,H),D.push({data:a,name:"Sequence",className:"AA",color:"black",type:"text"}),G.push({title:"Sequence",y:H-8})),c.showAxis&&j(H),m(),c.brushActive&&(E.brushActive=!0,K=!0,p()),c.verticalLine&&(E.verticalLine=!0,u()),l(H)}var w=this;this.events={FEATURE_SELECTED_EVENT:"feature-viewer-position-selected"};var x,y,z,A,B,b=b,C=document.getElementById(b.substring(1)),a=a,D=[],E={showSequence:!1,brushActive:!1,verticalLine:!1},F=0,G=[],H=20,I=0,J=0,K=!1,L=50,M={};d3.select(b).style("position","relative").style("padding","0px").style("z-index","2");var N={top:10,right:20,bottom:20,left:110},O=$(b).width()-N.left-N.right-17,P=600-N.top-N.bottom,Q=d3.scale.linear().domain([1,a.length]).range([5,O-5]),R=d3.scale.linear().domain([0,O]).range([1,a.length]);d3.helper={},d3.helper.tooltip=function(a){function c(c){c.on("mouseover.tooltip",function(c,d){d3.select("body").selectAll("div.tooltip").remove();var g=d3.mouse(h),i=g[0]>O;if(i?f=d3.select(b).append("div").attr("class","tooltip3"):(f=d3.select(b).append("div").attr("class","tooltip2"),f.style({left:g[0]-15+"px"})),f.style({top:g[1]-55+"px","background-color":"rgba(0, 0, 0, 0.8)",width:"auto","max-width":"170px",height:"auto","max-height":"43px",padding:"5px",font:"10px sans-serif","text-align":"center",position:"absolute","z-index":45,"box-shadow":"0 1px 2px 0 #656565"}),"path"===a.type)var j='<p style="margin:2px;color:white">start : <span style="color:orangered">'+c[0].x+"</span></p>",k='<p style="margin:2px;color:white">end : <span style="color:orangered">'+c[1].x+"</span></p>";else if("line"===a.type)var l=e(g[0],c),j='<p style="margin:2px;color:white">position : <span style="color:orangered" id="tLineX">'+l.x+"</span></p>",k='<p style="margin:2px;color:white">count : <span style="color:orangered" id="tLineC">'+l.y+"</span></p>";else if("unique"===a.type||c.x===c.y){var j='<p style="margin:2px;color:orangered">'+c.x+"</p>";if(c.description)var k='<p style="margin:2px;color:white;font-size:9px">'+c.description+"</p>";else var k=""}else{var j='<p style="margin:2px;color:orangered">'+c.x+" - "+c.y+"</p>";if(c.description)var k='<p style="margin:2px;color:white;font-size:9px">'+c.description+"</p>";else var k=""}f.html(j+k),i&&f.style({left:g[0]+10-f.node().getBoundingClientRect().width+"px"})}).on("mousemove.tooltip",function(b,c){if("line"===a.type){var d=d3.mouse(h),g=e(d[0],b);$("#tLineX").text(g.x),$("#tLineC").text(g.y)}if(void 0!==f){var d=d3.mouse(h),i=d[0]>O;i?(f.attr("class","tooltip3"),f.style({left:d[0]+10-f.node().getBoundingClientRect().width+"px",top:d[1]-55+"px"})):(f.attr("class","tooltip2"),f.style({left:d[0]-15+"px",top:d[1]-55+"px"}))}}).on("mouseout.tooltip",function(a,b){f.remove()}).on("click",function(c,f){var i,j,k,l,m;if("text"===this.nodeName){var n="#"+this.previousSibling.id;console.log(n),"#"!==n.nodeName&&d(n,a)}else d(this,a);var o=d3.select(".background").attr("width");if(d3.select("body").selectAll("div.selectedRect").remove(),g=d3.select(b).append("div").attr("class","selectedRect"),"path"===a.type)i=c[0].x,j=c[1].x;else if("line"===a.type){var p=d3.mouse(h);m=e(p[0],c),i=m.x-.5,j=m.x+.5}else"unique"===a.type||c.x===c.y?(i=c.x-.4,j=c.y+.4):(i=c.x,j=c.y);if(Q(i)<0&&Q(j)>o?(k=N.left,l=parseInt(o)+5):Q(i)<0?(k=N.left,l=Q(j)):Q(j)>o?(k=Q(i)+N.left,l=parseInt(o)-Q(i),l+=5):(k=Q(i)+N.left,l=Q(j)-Q(i)),g.style({left:k+"px",top:$(b+" .svgHeader").length?"60px":"10px","background-color":"rgba(0, 0, 0, 0.2)",width:l+"px",height:H+50+"px",position:"absolute","z-index":-1,"box-shadow":"0 1px 2px 0 #656565"}),CustomEvent){var q=new CustomEvent(w.events.FEATURE_SELECTED_EVENT,{detail:{start:"path"===a.type?c[0].x:"line"===a.type?m.x:c.x,end:"path"===a.type?c[1].x:"line"===a.type?m.y:c.y,id:"path"===a.type?c[0].id:"line"===a.type?m.id:c.id,description:"path"===a.type?c[0].description:"line"===a.type?m.description:c.description}});x.dispatchEvent(q)}else console.warn("CustomEvent is not defined....");w.trigger&&w.trigger(w.events.FEATURE_SELECTED_EVENT,{start:"path"===a.type?c[0].x:"line"===a.type?m.x:c.x,end:"path"===a.type?c[1].x:"line"===a.type?m.y:c.y,id:"path"===a.type?c[0].id:"line"===a.type?m.id:c.id,description:"path"===a.type?c[0].description:"line"===a.type?m.description:c.description})})}var f,g,h=d3.select(b).node();return c.attr=function(a){return arguments.length?(attrs=a,this):attrs},c.style=function(a){return arguments.length?(styles=a,this):styles},c};var S=function(a){return Q(a.x)},T=function(a){return O/a>5},U=function(a){return Q(a.y)-Q(a.x)};this.onFeatureSelected=function(a){x.addEventListener(w.events.FEATURE_SELECTED_EVENT,a)};var V=d3.svg.line().interpolate("step-before").x(function(a){return Q(a.x)}).y(function(a){return 10*-a.y+F}),W=d3.svg.line().x(function(a){return Q(a.x)}).y(function(a){return 10*X(-a.y)+F}),X=d3.scale.linear().domain([0,-30]).range([0,-20]),Y=d3.svg.line().interpolate("linear").x(function(a){return Q(a.x)}).y(function(a){return a.y+6}),Z=d3.svg.axis().scale(Q).tickFormat(d3.format("d")).orient("bottom"),_=d3.scale.ordinal().domain([0,G.length]).rangeRoundBands([0,500],.1),aa=(d3.svg.axis().scale(_).tickValues(G).tickFormat(function(a){return a}).orient("left"),{path:function(a){a.data.sort(function(a,b){return a.x-b.x});var b=h(a.data);a.data=a.data.map(function(a){return[{x:a.x,y:0,id:a.id,description:a.description,color:a.color},{x:a.y,y:a.level+1,id:a.id},{x:a.y,y:0,id:a.id}]}),F=10*b+5,a.height=10*b+5},line:function(b){b.height||(b.height=10);var c=parseInt(b.height),d=0;for(var e in b.data){b.data[e].sort(function(a,b){return a.x-b.x}),1!==b.data[e][0].x&&b.data[e].unshift({x:1,y:0}),b.data[e][b.data[e].length-1]!==a.length-1&&b.data[e].push({x:a.length-1,y:0});var f=Math.max.apply(Math,b.data[e].map(function(a){return Math.abs(a.y)}));d=f>d?f:d,b.data[e]=[b.data[e].map(function(a){return{x:a.x,y:a.y,id:a.id}})]}X.range([0,-c]).domain([0,-d]),F=10*c+5,b.level=d,b.shift=10*c+5},multipleRect:function(a){a.data.sort(function(a,b){return a.x-b.x}),I=h(a.data),F=10*I+5}}),ba={typeIdentifier:function(b){if("rect"===b.type)aa.multipleRect(b),G.push({title:b.name,y:H,filter:b.filter}),ba.rectangle(b,a,H,I);else if("text"===b.type)ba.sequence(b.data,H),G.push({title:b.name,y:H,filter:b.filter}),Q.range([5,O-5]);else if("unique"===b.type)ba.unique(b,a,H),G.push({title:b.name,y:H,filter:b.filter});else if("multipleRect"===b.type)aa.multipleRect(b),ba.multipleRect(b,a,H,I),G.push({title:b.name,y:H,filter:b.filter}),H+=10*(I-1);else if("path"===b.type)aa.path(b),ba.path(b,a,H),H+=F,G.push({title:b.name,y:H-10,filter:b.filter});else if("line"===b.type){Array.isArray(b.data[0])||(b.data=[b.data]),Array.isArray(b.color)||(b.color=[b.color]);var c=!1;b.data.forEach(function(a){a.filter(function(a){return a.y<0}).length&&(c=!0)}),aa.line(b),ba.line(b,a,H),H+=F,G.push({title:b.name,y:H-10,filter:b.filter}),H+=c?F-5:0}},sequence:function(a,b,c){if(!c)var c=0;z.append("g").attr("class","seqGroup").selectAll(".AA").data(a).enter().append("text").attr("clip-path","url(#clip)").attr("class","AA").attr("text-anchor","middle").attr("x",function(a,b){return Q.range([5,O-5])(b+1+c)}).attr("y",b).attr("font-size","10px").attr("font-family","monospace").text(function(a,b){return a})},rectangle:function(a,b,c){for(var d=a.height?a.height:12,e=d+d/3,h=d/2-6,i=z.append("g").attr("class","rectangle").attr("clip-path","url(#clip)").attr("transform","translate(0,"+c+")"),j=0;I>j;j++)i.append("path").attr("d",Y([{x:1,y:j*e+h},{x:b.length,y:j*e+h}])).attr("class",function(){return"line"+a.className}).style("z-index","0").style("stroke",a.color).style("stroke-width","1px");var k=i.selectAll("."+a.className+"Group").data(a.data).enter().append("g").attr("class",a.className+"Group").attr("transform",function(a){return"translate("+f(a)+",0)"});k.append("rect").attr("class","element "+a.className).attr("id",function(a){return"f"+a.id}).attr("y",function(a){return a.level*e}).attr("width",g).attr("height",d).style("fill",function(b){return b.color||a.color}).style("z-index","13").call(d3.helper.tooltip(a)),k.append("text").attr("class","element "+a.className+"Text").attr("y",function(a){return a.level*e+d/2}).attr("dy","0.35em").style("font-size","10px").text(function(a){return a.description}).style("fill","black").style("z-index","15").style("visibility",function(a){return a.description&&Q(a.y)-Q(a.x)>8*a.description.length?"visible":"hidden"}).call(d3.helper.tooltip(a)),o(k);var l=2>I&&d-15>0?d-15:0;H+=(I-1)*(e+h+1)+l},unique:function(a,b,c){var d=z.append("g").attr("class","uniquePosition").attr("transform","translate(0,"+c+")");d.append("path").attr("d",Y([{x:1,y:0},{x:b.length,y:0}])).attr("class",function(){return"line"+a.className}).style("z-index","0").style("stroke",a.color).style("stroke-width","1px"),d.selectAll("."+a.className).data(a.data).enter().append("rect").attr("clip-path","url(#clip)").attr("class","element "+a.className).attr("id",function(a){return"f"+a.id}).attr("x",function(a){return Q(a.x-.4)}).attr("width",function(a){return Q(a.x+.4)-Q(a.x-.4)<2?2:Q(a.x+.4)-Q(a.x-.4)}).attr("height",12).style("fill",function(b){return b.color||a.color}).style("z-index","3").call(d3.helper.tooltip(a)),o(d)},path:function(a,b,c){var d=z.append("g").attr("class","pathing").attr("transform","translate(0,"+c+")");d.append("path").attr("d",V([{x:1,y:0},{x:b.length,y:0}])).style("z-index","0").style("stroke",a.color).style("stroke-width","1px"),d.selectAll("."+a.className).data(a.data).enter().append("path").attr("clip-path","url(#clip)").attr("class","element "+a.className).attr("id",function(a){return"f"+a[0].id}).attr("d",V).style("fill","none").style("stroke",function(b){return b[0].color||a.color}).style("z-index","3").style("stroke-width","2px").call(d3.helper.tooltip(a)),o(d)},line:function(a,b,c){a.interpolation||(a.interpolation="monotone"),void 0===a.fill&&(a.fill=!0),console.log(a.color);var d=z.append("g").attr("class","lining").attr("transform","translate(0,"+c+")");d.append("path").attr("d",V([{x:1,y:0},{x:b.length,y:0}])).style("z-index","0").style("stroke","black").style("stroke-width","1px"),a.data.forEach(function(b,c,e){d.selectAll("."+a.className+c).data(b).enter().append("path").attr("clip-path","url(#clip)").attr("class","element "+a.className+" "+a.className+c).attr("d",W.interpolate(a.interpolation)).style("fill",a.fill?i(.6,a.color[c])||i(.6,"#000"):"none").style("stroke",a.color[c]||"#000").style("z-index","3").style("stroke-width","2px").call(d3.helper.tooltip(a))}),o(d)},multipleRect:function(a,b,c,d){for(var e=8,f=10,g=z.append("g").attr("class","multipleRects").attr("transform","translate(0,"+c+")"),h=0;d>h;h++)g.append("path").attr("d",Y([{x:1,y:h*f-2},{x:b.length,y:h*f-2}])).attr("class",function(){return"line"+a.className}).style("z-index","0").style("stroke",a.color).style("stroke-width","1px");g.selectAll("."+a.className).data(a.data).enter().append("rect").attr("clip-path","url(#clip)").attr("class","element "+a.className).attr("id",function(a){return"f"+a.id}).attr("x",S).attr("y",function(a){return a.level*f}).attr("width",U).attr("height",e).style("fill",function(b){return b.color||a.color}).style("z-index","13").call(d3.helper.tooltip(a)),o(g)}};this.showFilteredFeature=function(a,b){var c=(A.selectAll("."+a+"Arrow"),N.left-105),d=N.left-7,e=y.append("linearGradient").attr("y1","0").attr("y2","0").attr("x1",c).attr("x2",d).attr("id","gradient").attr("spreadMethod","pad").attr("gradientUnits","userSpaceOnUse");e.append("stop").attr("offset","0.3").attr("stop-color","#DFD5D3").attr("stop-opacity",1);var f=e.append("stop").attr("offset","1").attr("stop-opacity",1).attr("stop-color","#DFD5D3");f.attr("stop-color",b);var g=A.selectAll("."+a+"Arrow").style("fill","url(#gradient)").style("stroke","").attr("filter","url(#dropshadow)");g.attr("points",function(a){return N.left-105+","+(a.y-3)+", "+(N.left-105)+","+(a.y+12)+", "+(N.left-10)+","+(a.y+12)+", "+(N.left-2)+","+(a.y+4.5)+", "+(N.left-10)+","+(a.y-3)})},this.hideFilteredFeature=function(a){A.selectAll("."+a+"Arrow").style("fill","rgba(95,46,38,0.2)").attr("filter","").attr("points",function(a){return N.left-105+","+(a.y-3)+", "+(N.left-105)+","+(a.y+12)+", "+(N.left-15)+","+(a.y+12)+", "+(N.left-7)+","+(a.y+4.5)+", "+(N.left-15)+","+(a.y-3)})};var ca={rectangle:function(b){a.length<1500?(transit1=z.selectAll("."+b.className+"Group").transition().duration(500),transit2=z.selectAll("."+b.className).transition().duration(500)):(transit1=z.selectAll("."+b.className+"Group"),transit2=z.selectAll("."+b.className)),transit1.attr("transform",function(a){return"translate("+f(a)+",0)"}),transit2.attr("width",g),z.selectAll("."+b.className+"Text").style("visibility",function(a){return a.description&&Q(a.y)-Q(a.x)>8*a.description.length?"visible":"hidden"})},multiRec:function(a){z.selectAll("."+a.className).attr("x",function(a){return Q(a.x)}).attr("width",function(a){return Q(a.y)-Q(a.x)})},unique:function(a){z.selectAll("."+a.className).attr("x",function(a){return Q(a.x-.4)}).attr("width",function(a){return Q(a.x+.4)-Q(a.x-.4)<2?2:Q(a.x+.4)-Q(a.x-.4)})},path:function(b){var c;c=a.length<1500?z.selectAll("."+b.className).transition().duration(500):z.selectAll("."+b.className),c.attr("d",V.y(function(a){return 10*-a.y+b.height}))},line:function(b){X.range([0,-b.height]).domain([0,-b.level]);var c;c=a.length<1500?z.selectAll("."+b.className).transition().duration(500):z.selectAll("."+b.className),c.attr("d",W.y(function(a){return 10*X(-a.y)+b.shift}).interpolate(b.interpolation))},text:function(b,c){var d;d=a.length<1500?z.selectAll("."+b.className).transition().duration(500):z.selectAll("."+b.className),d.attr("x",function(a,b){return Q(b+1+c)})}},da=d3.svg.brush().x(Q).on("brushend",q);this.addRectSelection=function(a){var c,e,f,g,h=d3.select(a),i=h.data(),j=d3.select(".background").attr("width");d3.select("body").selectAll("div.selectedRect").remove();var k={type:h[0][0].tagName,color:h.style("fill")};d(a,k);var l=d3.select(b).append("div").attr("class","selectedRect");3===i[0].length?(c=i[0][0].x,e=i[0][1].x):i[0].x===i[0].y?(c=i[0].x-.5,e=i[0].y+.5):(c=i[0].x,e=i[0].y),Q(c)<0?(f=N.left,g=Q(e)):Q(e)>j?(f=Q(c)+N.left,g=j-Q(c)):(f=Q(c)+N.left,g=Q(e)-Q(c)),l.style({left:f+"px",top:"60px","background-color":"rgba(0, 0, 0, 0.2)",width:g+"px",height:H+50+"px",position:"absolute","z-index":-1,"box-shadow":"0 1px 2px 0 #656565"})},v(b,c),this.addFeature=function(a){H+=20,D.push(a),ba.typeIdentifier(a),n(),k(H),l(H),E.brushActive&&z.selectAll(".brush rect").attr("height",H+50),E.verticalLine&&d3.selectAll(".Vline").style("height",H+50+"px")}}return a}();"object"==typeof module&&"object"==typeof module.exports&&(module.exports=FeatureViewer);